# OrganADR é¡¹ç›®æ•°æ®æ–‡ä»¶æ¸…å•

## ğŸ“ æ•°æ®æ–‡ä»¶åˆ†ç±»

é¡¹ç›®ä¸­çš„æ•°æ®æ–‡ä»¶ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

---

## 1ï¸âƒ£ **åŸå§‹è®­ç»ƒæ•°æ®é›†** (datasets/)

**ä½ç½®**: `Part_02---Demo_of_Training_and_Evaluating_OrganADR/datasets/`

### 1.1 DDIæ•°æ®é›†ï¼ˆè¯ç‰©-è¯ç‰©ç›¸äº’ä½œç”¨ï¼‰

#### æ•°æ®é›†æ–‡ä»¶ç»“æ„ï¼š
```
datasets/
â”œâ”€â”€ dataset3/
â”‚   â”œâ”€â”€ D/              # æ•°æ®æº D
â”‚   â”‚   â””â”€â”€ 15/         # æ•°æ®ç§å­ 15
â”‚   â”‚       â”œâ”€â”€ train.txt    # è®­ç»ƒé›†ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰
â”‚   â”‚       â”œâ”€â”€ train.pkl   # è®­ç»ƒé›†ï¼ˆpickleæ ¼å¼ï¼Œé¢„å¤„ç†åçš„ï¼‰
â”‚   â”‚       â”œâ”€â”€ train_mat.npy  # è®­ç»ƒçŸ©é˜µï¼ˆnumpyæ ¼å¼ï¼‰
â”‚   â”‚       â”œâ”€â”€ valid.txt   # éªŒè¯é›†
â”‚   â”‚       â”œâ”€â”€ valid.pkl   # éªŒè¯é›†ï¼ˆpickleï¼‰
â”‚   â”‚       â”œâ”€â”€ test.txt    # æµ‹è¯•é›†
â”‚   â”‚       â””â”€â”€ test.pkl    # æµ‹è¯•é›†ï¼ˆpickleï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ R/              # æ•°æ®æº R
â”‚       â””â”€â”€ 15/
â”‚           â””â”€â”€ [åŒä¸Šç»“æ„]
```

#### æ–‡ä»¶æ ¼å¼è¯´æ˜ï¼š

**`.txt` æ–‡ä»¶æ ¼å¼**ï¼š
```
è¯ç‰©ID1  è¯ç‰©ID2  å…³ç³»å‘é‡(15ç»´ï¼Œé€—å·åˆ†éš”)  æ ‡ç­¾(1=æ­£æ ·æœ¬, 0=è´Ÿæ ·æœ¬)
```
ç¤ºä¾‹ï¼š
```
229	422	1,1,0,1,1,1,1,1,1,1,1,1,1,1,1	1
114	116	1,1,0,1,1,1,1,1,1,1,1,1,1,1,1	0
```

- **train.txt / train.pkl**: è®­ç»ƒé›†æ•°æ®
- **valid.txt / valid.pkl**: éªŒè¯é›†æ•°æ®  
- **test.txt / test.pkl**: æµ‹è¯•é›†æ•°æ®
- **train_mat.npy**: è®­ç»ƒçŸ©é˜µï¼ˆNumPyæ•°ç»„æ ¼å¼ï¼‰

---

### 1.2 çŸ¥è¯†å›¾è°±æ•°æ®

**æ–‡ä»¶**: `datasets/KG1_H.txt`

**æ ¼å¼**ï¼š
```
å®ä½“ID1  å®ä½“ID2  å…³ç³»ID
```
ç¤ºä¾‹ï¼š
```
10170	4148	26
9932	6345	17
232	8171	17
```

**è¯´æ˜**: çŸ¥è¯†å›¾è°±ä¸‰å…ƒç»„ï¼Œç”¨äºæ„å»ºå®ä½“å’Œå…³ç³»çš„å›¾ç»“æ„

---

## 2ï¸âƒ£ **é¢„å¤„ç†æ•°æ®** (preprocessed_data/)

**ä½ç½®**: `Part_02---Demo_of_Training_and_Evaluating_OrganADR/preprocessed_data/`

### é¢„å¤„ç†åçš„ç‰¹å¾æ•°æ®

**æ–‡ä»¶**: `id2drugfeature_new_639.pkl`

**è¯´æ˜**: 
- è¯ç‰©ç‰¹å¾æ˜ å°„æ–‡ä»¶ï¼ˆpickleæ ¼å¼ï¼‰
- åŒ…å«639ç§è¯ç‰©çš„ç‰¹å¾å‘é‡
- åœ¨è®­ç»ƒä»£ç ä¸­é€šè¿‡ `pickle.load()` åŠ è½½
- ç”¨äºæ¨¡å‹çš„è¯ç‰©ç‰¹å¾åµŒå…¥

---

## 3ï¸âƒ£ **è®­ç»ƒç»“æœæ•°æ®** (results/)

**ä½ç½®**: `Part_02---Demo_of_Training_and_Evaluating_OrganADR/results/`

### 3.1 å½“å‰è®­ç»ƒç»“æœ (results/demo/)

**ç»“æ„**ï¼š
```
results/demo/
â””â”€â”€ {å®éªŒç›®å½•å}/    # ä¾‹å¦‚: dataset3_D_H_F_O_A_loss2_eval2_15_10_20250403_060317
    â”œâ”€â”€ ndim=32_lr=0.001_bs=32_lamb=1e-06_gdim=16.txt  # è®­ç»ƒæ—¥å¿—
    â”œâ”€â”€ v_result_{epoch}.pkl  # éªŒè¯é›†é¢„æµ‹ç»“æœï¼ˆæ¯ä¸ªepochï¼‰
    â”œâ”€â”€ t_result_{epoch}.pkl  # æµ‹è¯•é›†é¢„æµ‹ç»“æœï¼ˆæ¯ä¸ªepochï¼‰
    â””â”€â”€ model_{epoch}.pth      # æ¨¡å‹æƒé‡æ–‡ä»¶ï¼ˆæ¯ä¸ªepochï¼‰
```

**æ–‡ä»¶è¯´æ˜**ï¼š
- **`.txt` æ—¥å¿—æ–‡ä»¶**: åŒ…å«æ¯ä¸ªepochçš„å®Œæ•´è¯„ä¼°æŒ‡æ ‡
- **`v_result_*.pkl`**: éªŒè¯é›†çš„è¯¦ç»†é¢„æµ‹ç»“æœï¼ˆåˆ†æ•°ã€é¢„æµ‹ã€æ ‡ç­¾ï¼‰
- **`t_result_*.pkl`**: æµ‹è¯•é›†çš„è¯¦ç»†é¢„æµ‹ç»“æœ
- **`model_*.pth`**: PyTorchæ¨¡å‹æƒé‡æ–‡ä»¶

### 3.2 å‚è€ƒç»“æœ (results/demo_for_reference/)

**è¯´æ˜**: å·²å®Œæˆçš„è®­ç»ƒç»“æœç¤ºä¾‹ï¼Œç”¨äºå‚è€ƒå’Œå¯¹æ¯”

---

## 4ï¸âƒ£ **é…ç½®æ–‡ä»¶** (config/)

**ä½ç½®**: `Part_02---Demo_of_Training_and_Evaluating_OrganADR/model/config/`

**æ–‡ä»¶**: `demo.json`

**è¯´æ˜**: è®­ç»ƒé…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬ï¼š
- æ•°æ®é›†è·¯å¾„
- è¶…å‚æ•°è®¾ç½®
- å®éªŒç»„åˆåˆ—è¡¨

---

## ğŸ“Š æ•°æ®æ–‡ä»¶ç»Ÿè®¡

### æŒ‰ç±»å‹åˆ†ç±»ï¼š

| ç±»å‹ | æ‰©å±•å | æ•°é‡ | ç”¨é€” |
|------|-------|------|------|
| **è®­ç»ƒæ•°æ®** | .txt | 6ä¸ª | DDIæ•°æ®é›†ï¼ˆtrain/valid/test Ã— 2ä¸ªæ•°æ®æºï¼‰ |
| **é¢„å¤„ç†æ•°æ®** | .pkl | 7ä¸ª | é¢„å¤„ç†çš„è®­ç»ƒæ•°æ®å’Œè¯ç‰©ç‰¹å¾ |
| **çŸ©é˜µæ•°æ®** | .npy | 2ä¸ª | NumPyæ ¼å¼çš„è®­ç»ƒçŸ©é˜µ |
| **çŸ¥è¯†å›¾è°±** | .txt | 1ä¸ª | çŸ¥è¯†å›¾è°±ä¸‰å…ƒç»„ |
| **è®­ç»ƒç»“æœ** | .txt | Nä¸ª | è®­ç»ƒæ—¥å¿—ï¼ˆæ¯ä¸ªå®éªŒæ¯ä¸ªepochï¼‰ |
| **é¢„æµ‹ç»“æœ** | .pkl | Nä¸ª | éªŒè¯/æµ‹è¯•é›†é¢„æµ‹ç»“æœ |
| **æ¨¡å‹æƒé‡** | .pth | Nä¸ª | è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡ |
| **é…ç½®æ–‡ä»¶** | .json | 1ä¸ª | è®­ç»ƒé…ç½® |

### æŒ‰ç›®å½•åˆ†ç±»ï¼š

```
ğŸ“ datasets/                  # åŸå§‹å’Œé¢„å¤„ç†æ•°æ®é›†
   â”œâ”€â”€ dataset3/              # æ•°æ®é›†3
   â”‚   â”œâ”€â”€ D/15/              # æ•°æ®æºDï¼Œç§å­15
   â”‚   â””â”€â”€ R/15/              # æ•°æ®æºRï¼Œç§å­15
   â””â”€â”€ KG1_H.txt              # çŸ¥è¯†å›¾è°±

ğŸ“ preprocessed_data/         # é¢„å¤„ç†æ•°æ®
   â””â”€â”€ id2drugfeature_new_639.pkl  # è¯ç‰©ç‰¹å¾

ğŸ“ results/                   # è®­ç»ƒç»“æœ
   â”œâ”€â”€ demo/                  # å½“å‰è®­ç»ƒç»“æœ
   â””â”€â”€ demo_for_reference/    # å‚è€ƒç»“æœ

ğŸ“ model/config/              # é…ç½®æ–‡ä»¶
   â””â”€â”€ demo.json
```

---

## ğŸ” æ•°æ®æ–‡ä»¶ä½¿ç”¨è¯´æ˜

### è®­ç»ƒæ—¶ä½¿ç”¨çš„æ•°æ®æ–‡ä»¶ï¼š

1. **è®­ç»ƒä»£ç åŠ è½½** (`train_and_evaluate_demo.py`):
   - `datasets/{dataset}/{datasource}/{dataseed}/train.txt` - è®­ç»ƒé›†
   - `datasets/{dataset}/{datasource}/{dataseed}/valid.txt` - éªŒè¯é›†
   - `datasets/{dataset}/{datasource}/{dataseed}/test.txt` - æµ‹è¯•é›†
   - `datasets/KG1_{kg}.txt` - çŸ¥è¯†å›¾è°±
   - `preprocessed_data/id2drugfeature_new_639.pkl` - è¯ç‰©ç‰¹å¾

### åˆ†ææ—¶ä½¿ç”¨çš„æ•°æ®æ–‡ä»¶ï¼š

1. **ç»“æœåˆ†æè„šæœ¬** (`analyze_results.py`):
   - `results/demo/*/ndim=*.txt` - è®­ç»ƒæ—¥å¿—
   - `results/demo/*/v_result_*.pkl` - éªŒè¯é›†ç»“æœï¼ˆå¯é€‰ï¼‰
   - `results/demo/*/t_result_*.pkl` - æµ‹è¯•é›†ç»“æœï¼ˆå¯é€‰ï¼‰

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **`.pkl` æ–‡ä»¶**: Python pickleæ ¼å¼ï¼Œéœ€è¦ç”¨Pythonçš„pickleæ¨¡å—è¯»å–
2. **`.npy` æ–‡ä»¶**: NumPyæ•°ç»„æ ¼å¼ï¼Œéœ€è¦ç”¨ `np.load()` è¯»å–
3. **`.pth` æ–‡ä»¶**: PyTorchæ¨¡å‹æƒé‡ï¼Œéœ€è¦ç”¨ `torch.load()` åŠ è½½
4. **æ•°æ®è·¯å¾„**: è®­ç»ƒä»£ç ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œéœ€ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•ä¸‹è¿è¡Œ
5. **æ•°æ®å¤§å°**: çŸ¥è¯†å›¾è°±æ–‡ä»¶ï¼ˆKG1_H.txtï¼‰å¯èƒ½è¾ƒå¤§ï¼ˆ30ä¸‡+è¡Œï¼‰
6. **ç‰ˆæœ¬å…¼å®¹æ€§**: pickleæ–‡ä»¶å¯èƒ½å—Pythonç‰ˆæœ¬å½±å“ï¼Œå»ºè®®ä½¿ç”¨ç›¸åŒç‰ˆæœ¬è¯»å–

---

## ğŸ¯ æ•°æ®æ–‡ä»¶æŸ¥æ‰¾æ¸…å•

å¦‚æœéœ€è¦æŸ¥æ‰¾ç‰¹å®šç±»å‹çš„æ•°æ®æ–‡ä»¶ï¼š

- **åŸå§‹è®­ç»ƒæ•°æ®** â†’ `Part_02---Demo_of_Training_and_Evaluating_OrganADR/datasets/`
- **é¢„å¤„ç†ç‰¹å¾** â†’ `Part_02---Demo_of_Training_and_Evaluating_OrganADR/preprocessed_data/`
- **è®­ç»ƒç»“æœ** â†’ `Part_02---Demo_of_Training_and_Evaluating_OrganADR/results/demo/`
- **å‚è€ƒç»“æœ** â†’ `Part_02---Demo_of_Training_and_Evaluating_OrganADR/results/demo_for_reference/`
- **é…ç½®æ–‡ä»¶** â†’ `Part_02---Demo_of_Training_and_Evaluating_OrganADR/model/config/`

